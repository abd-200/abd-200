<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ø³ÙŠØ§Ø­ÙŠØ© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ© Ù„Ù…Ø­Ø§ÙØ¸Ø© Ø¹Ø¬Ù„ÙˆÙ†</title>
    
    <!-- Ù…ÙƒØªØ¨Ø§Øª Leaflet -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.Default.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet-search@3.0.2/dist/leaflet-search.src.css">
    
    <style>
        #map {
            height: 100vh;
            width: 100%;
        }
        
        .control-panel {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.9);
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0,0,0,0.2);
            max-width: 300px;
        }
        
        .filter-item {
            margin: 8px 0;
        }
        
        .popup-content {
            text-align: right;
            min-width: 200px;
        }
        
        .popup-image {
            width: 100%;
            max-height: 150px;
            object-fit: cover;
            border-radius: 5px;
            margin: 5px 0;
        }
    </style>
</head>
<body>

<div class="control-panel">
    <input type="text" id="search" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…ÙˆÙ‚Ø¹ Ø³ÙŠØ§Ø­ÙŠ..." style="width: 100%; padding: 8px; margin-bottom: 10px;">
    <div id="filters"></div>
</div>

<div id="map"></div>

<!-- Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© -->
<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
<script src="https://unpkg.com/leaflet.markercluster@1.4.1/dist/leaflet.markercluster.js"></script>
<script src="https://unpkg.com/leaflet-search@3.0.2/dist/leaflet-search.src.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-gpx/1.7.0/gpx.min.js"></script>

<script>
// Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
const categories = {
    touristic: { name: 'Ù…Ø¹Ø§Ù„Ù… Ø³ÙŠØ§Ø­ÙŠØ©', color: '#e74c3c', icon: 'ğŸ°' },
    nature: { name: 'Ø·Ø¨ÙŠØ¹Ø©', color: '#27ae60', icon: 'ğŸŒ³' },
    religious: { name: 'Ø¯ÙŠÙ†ÙŠØ©', color: '#f1c40f', icon: 'ğŸ•Œ' },
    historical: { name: 'ØªØ§Ø±ÙŠØ®ÙŠØ©', color: '#8e44ad', icon: 'ğŸ›ï¸' },
    services: { name: 'Ø®Ø¯Ù…Ø§Øª', color: '#3498db', icon: 'ğŸª' }
};

// Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ù…Ø§ÙƒÙ† Ø§Ù„Ø³ÙŠØ§Ø­ÙŠØ©
const places = [
    {
        title: "Ù‚Ù„Ø¹Ø© Ø¹Ø¬Ù„ÙˆÙ†",
        position: [32.3348, 35.7622],
        category: "historical",
        description: "Ù‚Ù„Ø¹Ø© Ø¥Ø³Ù„Ø§Ù…ÙŠØ© ØªØ§Ø±ÙŠØ®ÙŠØ© Ø¨Ù†Ø§Ù‡Ø§ ØµÙ„Ø§Ø­ Ø§Ù„Ø¯ÙŠÙ† Ø§Ù„Ø£ÙŠÙˆØ¨ÙŠ",
        image: "https://example.com/ajloun-castle.jpg"
    },
    {
        title: "Ù…Ø­Ù…ÙŠØ© ØºØ§Ø¨Ø© Ø¹Ø¬Ù„ÙˆÙ†",
        position: [32.3112, 35.7765],
        category: "nature",
        description: "Ù…Ø­Ù…ÙŠØ© Ø·Ø¨ÙŠØ¹ÙŠØ© ØªØ¶Ù… Ø£Ø´Ø¬Ø§Ø± Ø§Ù„Ø¨Ù„ÙˆØ· ÙˆØ§Ù„ØµÙ†ÙˆØ¨Ø±",
        image: "https://example.com/forest.jpg"
    },
    {
        title: "Ù…Ù‚Ø§Ù… Ø§Ù„Ù†Ø¨ÙŠ Ù‡ÙˆØ¯",
        position: [32.3291, 35.7480],
        category: "religious",
        description: "Ù…Ù‚Ø§Ù… Ø¯ÙŠÙ†ÙŠ ÙŠØ¹ØªÙ‚Ø¯ Ø£Ù†Ù‡ Ù„Ù„Ù†Ø¨ÙŠ Ù‡ÙˆØ¯ Ø¹Ù„ÙŠÙ‡ Ø§Ù„Ø³Ù„Ø§Ù…"
    },
    {
        title: "ÙˆØ§Ø¯ÙŠ ÙƒÙØ±Ù†Ø¬Ø©",
        position: [32.3213, 35.7851],
        category: "nature",
        description: "ÙˆØ§Ø¯ÙŠ Ø®Ù„Ø§Ø¨ Ù…Ù†Ø§Ø³Ø¨ Ù„Ù„Ù…Ø´ÙŠ Ù„Ù…Ø³Ø§ÙØ§Øª Ø·ÙˆÙŠÙ„Ø©"
    },
    {
        title: "Ù…ØªØ­Ù Ø¹Ø¬Ù„ÙˆÙ† Ø§Ù„Ø£Ø«Ø±ÙŠ",
        position: [32.3451, 35.7589],
        category: "historical",
        description: "ÙŠØ¶Ù… Ù‚Ø·Ø¹Ø§Ù‹ Ø£Ø«Ø±ÙŠØ© Ù…Ù† Ù…Ø®ØªÙ„Ù Ø§Ù„Ø¹ØµÙˆØ±"
    },
    {
        title: "Ù…Ø·Ù„Ø§Øª Ø¹Ø¬Ù„ÙˆÙ†",
        position: [32.3233, 35.7970],
        category: "nature",
        description: "Ù…Ù†Ø§Ø¸Ø± Ø¨Ø§Ù†ÙˆØ±Ø§Ù…ÙŠØ© Ø®Ù„Ø§Ø¨Ø© Ù„Ù„Ù…Ù†Ø·Ù‚Ø©"
    },
    {
        title: "Ø¹ÙŠÙ† Ø§Ù… Ø§Ù„Ø´Ø±Ø§ÙŠØ·",
        position: [32.2976, 35.7276],
        category: "nature",
        description: "ÙŠÙ†Ø§Ø¨ÙŠØ¹ Ù…Ø§Ø¦ÙŠØ© Ø·Ø¨ÙŠØ¹ÙŠØ©"
    },
    {
        title: "Ù…Ø³Ø¬Ø¯ Ø¹Ø¬Ù„ÙˆÙ† Ø§Ù„ÙƒØ¨ÙŠØ±",
        position: [32.3671, 35.7375],
        category: "religious",
        description: "Ù…Ù† Ø£Ù‚Ø¯Ù… Ø§Ù„Ù…Ø³Ø§Ø¬Ø¯ ÙÙŠ Ø§Ù„Ù…Ù†Ø·Ù‚Ø©"
    },
    {
        title: "Ù…Ø±ÙƒØ² Ø²ÙˆØ§Ø± Ø¹Ø¬Ù„ÙˆÙ†",
        position: [32.3501, 35.7393],
        category: "services",
        description: "Ù…Ø±ÙƒØ² Ø®Ø¯Ù…Ø§Øª Ø³ÙŠØ§Ø­ÙŠØ© ÙˆÙ…Ø¹Ù„ÙˆÙ…Ø§Øª"
    }
];

// ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø®Ø±ÙŠØ·Ø©
const map = L.map('map').setView([32.3272, 35.7575], 12);

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: 'Â© OpenStreetMap contributors'
}).addTo(map);

// Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø·Ø¨Ù‚Ø§Øª
const layers = {
    touristic: L.layerGroup(),
    nature: L.layerGroup(),
    religious: L.layerGroup(),
    historical: L.layerGroup(),
    services: L.layerGroup()
};

// Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ù„Ø§Ù…Ø§Øª
places.forEach(place => {
    const marker = L.marker(place.position, {
        icon: L.divIcon({
            className: 'custom-icon',
            html: `<div style="background:${categories[place.category].color}">
                     ${categories[place.category].icon}
                   </div>`,
            iconSize: [32, 32]
        })
    }).bindPopup(`
        <div class="popup-content">
            <h3>${place.title}</h3>
            ${place.image ? `<img src="${place.image}" class="popup-image">` : ''}
            <p>${place.description}</p>
            <small>Ø§Ù„ÙØ¦Ø©: ${categories[place.category].name}</small>
        </div>
    `);
    
    layers[place.category].addLayer(marker);
});

// Ø¥Ø¶Ø§ÙØ© Ø¹Ù†Ø§ØµØ± Ø§Ù„ØªØ­ÙƒÙ…
L.control.layers(null, {
    [categories.touristic.name]: layers.touristic,
    [categories.nature.name]: layers.nature,
    [categories.religious.name]: layers.religious,
    [categories.historical.name]: layers.historical,
    [categories.services.name]: layers.services
}, { position: 'bottomright' }).addTo(map);

// Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¨Ø­Ø«
const searchControl = new L.Control.Search({
    layer: Object.values(layers).reduce((acc, layer) => acc.addLayer(layer), L.layerGroup()),
    propertyName: 'title',
    marker: false,
    moveToLocation: function(latlng, title, map) {
        map.setView(latlng, 15);
    }
}).addTo(map);

// Ø¥Ù†Ø´Ø§Ø¡ ÙÙ„Ø§ØªØ± Ø§Ù„ÙØ¦Ø§Øª
const filtersContainer = document.getElementById('filters');
Object.entries(categories).forEach(([key, category]) => {
    const div = document.createElement('div');
    div.className = 'filter-item';
    div.innerHTML = `
        <label>
            <input type="checkbox" checked 
                   onchange="toggleLayer('${key}')">
            ${category.icon} ${category.name}
        </label>
    `;
    filtersContainer.appendChild(div);
});

// ÙˆØ¸ÙŠÙØ© ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ø·Ø¨Ù‚Ø§Øª
window.toggleLayer = function(category) {
    if (map.hasLayer(layers[category])) {
        map.removeLayer(layers[category]);
    } else {
        map.addLayer(layers[category]);
    }
};

// Ø¥Ø¶Ø§ÙØ© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ø¨Ù‚Ø§Øª Ø¨Ø´ÙƒÙ„ Ø§ÙØªØ±Ø§Ø¶ÙŠ
Object.values(layers).forEach(layer => map.addLayer(layer));

// Ø¥Ø¶Ø§ÙØ© Ù…Ø³Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø´ÙŠ
new L.GPX('data/hiking-trails.gpx', {
    async: true,
    polyline_options: {
        color: '#27ae60',
        weight: 4
    }
}).addTo(map);
</script>

</body>
</html>